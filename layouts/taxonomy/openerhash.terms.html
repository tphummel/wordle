{{ define "main" }}
<h1>{{ .Title }}</h1>

<p>{{ partial "breadcrumb.html" . }}</p>

{{ with .Content }}
<div>{{ . }}</div>
{{ end }}

{{ $alphabetical := .Data.Terms.Alphabetical }}
{{ $completed := len $alphabetical }}
<p>Completed {{ $completed }} of 243 opener hash combinations.</p>

<h2>Opener Hash Checklist</h2>

<p>All 243 possible combinations in alphabetical order.</p>

{{/* Generate all 243 possible combinations */}}
{{ $values := slice "A" "P" "C" }}

<table>
  <tr>
    <th>Hash</th>
    <th>Emoji</th>
    <th>Count</th>
    <th>First Occurrence</th>
  </tr>

{{/* Generate all combinations using nested loops */}}
{{ range $v5 := $values }}
  {{ range $v4 := $values }}
    {{ range $v3 := $values }}
      {{ range $v2 := $values }}
        {{ range $v1 := $values }}
          {{ $combo := printf "%s%s%s%s%s" $v1 $v2 $v3 $v4 $v5 }}

          {{/* Find matching term */}}
          {{ $found := false }}
          {{ $foundTerm := dict }}
          {{ range $term := $alphabetical }}
            {{ if eq $term.Name $combo }}
              {{ $found = true }}
              {{ $foundTerm = $term }}
            {{ end }}
          {{ end }}

          <tr>
            <td>
              {{ if $found }}
                {{ with $.Site.GetPage (printf "/%s/%s" "openerhashes" $combo) }}
                  <a href="{{ .RelPermalink }}">{{ $combo }}</a>
                {{ end }}
              {{ else }}
                {{ $combo }}
              {{ end }}
            </td>
            <td>
              {{ if $found }}
                {{ $firstPage := index (first 1 $foundTerm.Pages.ByDate) 0 }}
                {{ partialCached "first-guess-emoji.html" $firstPage $firstPage.File.Path }}
              {{ else }}
                --
              {{ end }}
            </td>
            <td>{{ if $found }}{{ $foundTerm.Count }}{{ else }}--{{ end }}</td>
            <td>
              {{ if $found }}
                {{ $firstPage := index (first 1 $foundTerm.Pages.ByDate) 0 }}
                <a href="{{ $firstPage.RelPermalink }}">{{ $firstPage.Date.Format "Jan 2, 2006" }}</a>
              {{ else }}
                --
              {{ end }}
            </td>
          </tr>
        {{ end }}
      {{ end }}
    {{ end }}
  {{ end }}
{{ end }}
</table>

<h2>Opener Hashes Played</h2>

<p>Ordered by count (most played first).</p>

<table>
  <tr>
    <td>Emoji</td>
    <td>Count</td>
    <td>First Played</td>
    <td>Last Played</td>
  </tr>

  {{ $ordered := sort $alphabetical "Count" "desc" }}

  {{ range $term := $ordered }}
    {{ $name := $term.Name }}
    {{ $count := $term.Count }}
    {{ $first := index (first 1 $term.Pages.ByDate) 0 }}
    {{ $last := index (last 1 $term.Pages.ByDate) 0 }}

    {{ with $.Site.GetPage (printf "/%s/%s" "openerhashes" $name) }}
    <tr>
      <td><a href="{{ .RelPermalink }}" title="{{ $name }}">{{ partialCached "first-guess-emoji.html" $first $first.File.Path }}</a></td>
      <td>{{ $count }}</td>
      <td><a href="{{ $first.RelPermalink}}">{{ $first.Date.Format "Jan 2, 2006" }}</a></td>
      <td>{{ if gt $count 1 }}<a href="{{ $last.RelPermalink}}">{{ $last.Date.Format "Jan 2, 2006" }}</a>{{ else }}--{{ end }}</td>
    </tr>
    {{ end }}

  {{ end }}
</table>
{{ end }}
