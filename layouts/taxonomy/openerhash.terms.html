{{ define "main" }}
<h1>{{ .Title }}</h1>

<p>{{ partial "breadcrumb.html" . }}</p>

{{ with .Content }}
<div>{{ . }}</div>
{{ end }}

{{ $alphabetical := .Data.Terms.Alphabetical }}
{{ $completed := len $alphabetical }}
<p>Completed {{ $completed }} of 243 opener hash combinations.</p>

<h2>Opener Hash Checklist</h2>

<p>All 243 possible combinations in alphabetical order.</p>

{{/* Create a map of existing hashes for quick lookup */}}
{{ $hashMap := dict }}
{{ range $term := $alphabetical }}
  {{ $name := $term.Name }}
  {{ $count := $term.Count }}
  {{ $first := index (first 1 $term.Pages.ByDate) 0 }}
  {{ $hashMap = merge $hashMap (dict $name (dict "count" $count "first" $first "term" $term)) }}
{{ end }}

{{/* Generate all 243 possible combinations */}}
{{ $values := slice "A" "P" "C" }}
{{ $allCombos := slice }}

{{/* Generate all combinations using nested loops */}}
{{ range $v5 := $values }}
  {{ range $v4 := $values }}
    {{ range $v3 := $values }}
      {{ range $v2 := $values }}
        {{ range $v1 := $values }}
          {{ $combo := printf "%s%s%s%s%s" $v1 $v2 $v3 $v4 $v5 }}
          {{ $allCombos = $allCombos | append $combo }}
        {{ end }}
      {{ end }}
    {{ end }}
  {{ end }}
{{ end }}

<table>
  <tr>
    <th>Hash</th>
    <th>Emoji</th>
    <th>Count</th>
    <th>First Occurrence</th>
  </tr>

  {{ range $combo := $allCombos }}
    {{ $data := index $hashMap $combo }}
    <tr>
      <td>
        {{ if $data }}
          {{ with $.Site.GetPage (printf "/%s/%s" "openerhashes" $combo) }}
            <a href="{{ .RelPermalink }}">{{ $combo }}</a>
          {{ end }}
        {{ else }}
          {{ $combo }}
        {{ end }}
      </td>
      <td>
        {{ if $data }}
          {{ $firstPage := $data.first }}
          {{ partialCached "first-guess-emoji.html" $firstPage $firstPage.File.Path }}
        {{ else }}
          --
        {{ end }}
      </td>
      <td>{{ if $data }}{{ $data.count }}{{ else }}--{{ end }}</td>
      <td>
        {{ if $data }}
          {{ $firstPage := $data.first }}
          <a href="{{ $firstPage.RelPermalink }}">{{ $firstPage.Date.Format "Jan 2, 2006" }}</a>
        {{ else }}
          --
        {{ end }}
      </td>
    </tr>
  {{ end }}
</table>

<h2>Opener Hashes Played</h2>

<p>Ordered by count (most played first).</p>

<table>
  <tr>
    <td>Emoji</td>
    <td>Count</td>
    <td>First Played</td>
    <td>Last Played</td>
  </tr>

  {{ $ordered := sort $alphabetical "Count" "desc" }}

  {{ range $term := $ordered }}
    {{ $name := $term.Name }}
    {{ $count := $term.Count }}
    {{ $first := index (first 1 $term.Pages.ByDate) 0 }}
    {{ $last := index (last 1 $term.Pages.ByDate) 0 }}

    {{ with $.Site.GetPage (printf "/%s/%s" "openerhashes" $name) }}
    <tr>
      <td><a href="{{ .RelPermalink }}" title="{{ $name }}">{{ partialCached "first-guess-emoji.html" $first $first.File.Path }}</a></td>
      <td>{{ $count }}</td>
      <td><a href="{{ $first.RelPermalink}}">{{ $first.Date.Format "Jan 2, 2006" }}</a></td>
      <td>{{ if gt $count 1 }}<a href="{{ $last.RelPermalink}}">{{ $last.Date.Format "Jan 2, 2006" }}</a>{{ else }}--{{ end }}</td>
    </tr>
    {{ end }}

  {{ end }}
</table>
{{ end }}
