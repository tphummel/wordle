{{ define "main" }}

<h1>{{ .Site.Title }}</h1>


<blockquote>
  â—ï¸â›”ï¸ Note: You will not see puzzle solution spoilers anywhere on this site unless you opt in on an individual puzzle page by expanding the Guesses section.
</blockquote>

{{ $wordles := where .Site.RegularPages "Section" "w" }}
{{ $wins := where $wordles "Params.state.gameStatus" "WIN" }}
{{ $losses := where $wordles "Params.state.gameStatus" "FAIL"}}
{{ $nyt_puzzle_count := 2309 }}
{{ $nyt_valid_word_count := 10663 }}

<div>ğŸ§© Days Played: <strong><a href="{{ with .Site.GetPage "section" "w" }}{{ .RelPermalink }}{{ end }}">{{ len $wordles }}</a></strong></div>
{{ with .Site.GetPage "/puzzles" }}
<div>ğŸ§© Puzzles Played: <strong><a href="{{ .RelPermalink }}">{{ len .Pages }}</a></strong></div>
{{ end }}
<div>ğŸ§© Win Pct: <strong>{{ lang.NumFmt 3 (div (float (len $wins)) (len $wordles)) }} ({{ len $wins }}-{{ len $losses }})</strong></div>
<div>ğŸ§© Pct of Total Puzzles Played: <strong>{{ lang.NumFmt 2 (mul (div (float (len $wordles)) ($nyt_puzzle_count)) 100) }}% ({{ lang.NumFmt 0 (len $wordles) }}/{{ lang.NumFmt 0 $nyt_puzzle_count }})</strong></div>

{{ $total_guesses := 0}}
{{ range $wordles }}
  {{ $guesses := partial "guess-count" . }}
  {{ $guesses = cond (eq $guesses "X") 6 $guesses }}
  {{ $total_guesses = add $total_guesses $guesses }}
{{ end }}
<div>ğŸ§© Total Guesses: <strong><a href="{{ with .Site.GetPage "guesses" }}{{ .RelPermalink }}{{ end }}">{{ $total_guesses }}</a></strong></div>
<div>ğŸ§© Guesses per Puzzle:  <strong>{{ lang.NumFmt 2 (div (float $total_guesses) (len $wordles)) }}</strong></div>
<div>ğŸ§© Distinct Words Guessed: <strong><a href="{{ with .Site.GetPage "words" }}{{ .RelPermalink }}{{ end }}">{{ len .Site.Taxonomies.words }}</a></strong></div>
<div>ğŸ§© Pct of Words Guessed: <strong>{{ lang.NumFmt 2 (mul (div (float (len .Site.Taxonomies.words)) ($nyt_valid_word_count)) 100) }}% ({{ lang.NumFmt 0 (len .Site.Taxonomies.words) }}/{{ lang.NumFmt 0 ($nyt_valid_word_count) }})</strong></div>

<h2>ğŸ•° Recent Puzzles</h2>
<table>
  <tr>
    <th>Date</th>
    <th>Puzzle</th>
    <th>Turns</th>
    <th>Score</th>
  </tr>

  {{ range first 5 $wordles }}
    <tr>
      <td><a href="{{ .RelPermalink }}">{{ .Date.Format "Jan 2, 2006" }}</a></td>
      <td><a href="{{ .RelPermalink }}">{{ index .Params.puzzles 0 }}</a></td>
      <td><a href="{{ .RelPermalink }}">{{ partial "guess-count.html" . }}{{- cond (eq .Params.state.hardMode true) "*" "" -}}</a></td>
      <td><a href="{{ .RelPermalink }}">{{ partial "puzzle-score.html" . }}</a></td>
    </tr>

  {{ end }}
</table>

<h2>ğŸ¯ Guess Distribution</h2>
<table>
  <tr>
    <th>Guesses</th>
    <th># of Puzzles</th>
    <th>Pct of Total</th>
  </tr>

{{ $guessReports := slice nil "solve-in-one.md" "solve-in-two.md" "solve-in-three.md" "solve-in-four.md" "solve-in-five.md" "solve-in-six.md"}}

{{ range $guesses := seq 1 6 }}
  {{ $puzzles := len (where $wins "Params.state.rowIndex" $guesses) }}
  <tr>
    <td>{{ $guesses }}</td>
    <td><a href="{{ with $.Site.GetPage (index $guessReports $guesses) }}{{ .RelPermalink }}{{ end }}">{{ $puzzles }}</a></td>
    <td>{{ lang.NumFmt 2 (mul (div (float $puzzles) (len $wordles)) 100) }}%</td>
  </tr>
{{ end }}

<tr>
  <td>Loss</td>
  <td><a href="{{ with $.Site.GetPage "losses" }}{{ .RelPermalink }}{{ end }}">{{ len $losses }}</a></td>
  <td>{{ lang.NumFmt 2 (mul (div (float (len $losses)) (len $wordles)) 100) }}%</td>
</tr>
</table>

{{ $openerMisses := partial "opener-misses" $wordles }}

{{ with .Site.GetPage "opener-misses.md" }}
  <div>ğŸ§© Opener Misses: <strong><a href="{{ .RelPermalink }}">{{ len $openerMisses }}</a></strong></div>
{{ end }}

{{ $openerDoubleMisses := partial "opener-double-misses" $wordles }}

{{ with .Site.GetPage "opener-double-misses.md" }}
  <div>ğŸ§© Opener Double Misses: <strong><a href="{{ .RelPermalink }}">{{ len $openerDoubleMisses }}</a></strong></div>
{{ end }}

{{ with .Site.GetPage "no-yellow-tiles.md" }}
  {{ $noYellow := partial "no-yellow-tiles.html" (where .Site.RegularPages "Section" "w") }}
  <div>ğŸ§© Puzzles with no Yellow Tiles: <strong><a href="{{ .RelPermalink }}">{{ len $noYellow }}</a></strong></div>
{{ end }}

{{ with .Site.GetPage "no-green-before-solve.md" }}
  {{ $noGreenBeforeSolve := partial "no-green-before-solve.html" (where .Site.RegularPages "Section" "w") }}
  <div>ğŸ§© Puzzles with no Green Tiles Prior to Solving: <strong><a href="{{ .RelPermalink }}">{{ len $noGreenBeforeSolve }}</a></strong></div>
{{ end }}
{{ with .Site.GetPage "collections.md" }}
  <div>ğŸƒ <a href="{{ .RelPermalink }}">Collections</a></div>
{{ end }}

{{ range $wordles }}
  {{ $score := partial "puzzle-score" . }}
  {{ $.Scratch.Add "scored" (slice (dict "page" . "score" $score)) }}
{{ end }}

<h2>â¬‡ï¸ Low (ğŸ˜„) Scores</h2>
<table>
  <tr>
    <th>Date</th>
    <th>Puzzle</th>
    <th>Turns</th>
    <th>Score</th>
  </tr>

  {{ range first 5 (sort ($.Scratch.Get "scored") ".score" "asc") }}
    <tr>
      <td><a href="{{ .page.RelPermalink }}">{{ .page.Date.Format "Jan 2, 2006" }}</a></td>
      <td><a href="{{ .page.RelPermalink }}">{{ index .page.Params.puzzles 0 }}</a></td>
      <td><a href="{{ .page.RelPermalink }}">{{ partial "guess-count.html" .page }}{{- cond (eq .page.Params.state.hardMode true) "*" "" -}}</a></td>
      <td><a href="{{ .page.RelPermalink }}">{{ .score }}</a></td>
    </tr>
  {{ end }}
</table>

<h2>â¬†ï¸ High (ğŸ˜–) Scores</h2>
<table>
  <tr>
    <th>Date</th>
    <th>Puzzle</th>
    <th>Turns</th>
    <th>Score</th>
  </tr>

  {{ range first 5 (sort ($.Scratch.Get "scored") ".score" "desc") }}
    <tr>
      <td><a href="{{ .page.RelPermalink }}">{{ .page.Date.Format "Jan 2, 2006" }}</a></td>
      <td><a href="{{ .page.RelPermalink }}">{{ index .page.Params.puzzles 0 }}</a></td>
      <td><a href="{{ .page.RelPermalink }}">{{ partial "guess-count.html" .page }}{{- cond (eq .page.Params.state.hardMode true) "*" "" -}}</a></td>
      <td><a href="{{ .page.RelPermalink }}">{{ .score }}</a></td>
    </tr>
  {{ end }}
</table>

<h2>â›“ Top Streaks, Consec Days Played</h2>

{{ $streaks := partial "streak-days-played.html" $wordles }}

<table>
  <tr>
    <th>Start</th>
    <th>End</th>
    <th>Length</th>
    <th></th>
  </tr>

  {{ range first 5 (sort $streaks "length" "desc") }}
    <tr>
      <td><a href="{{ .start.RelPermalink }}">{{ .start.Date.Format "Jan 2, 2006" }}</a></td>
      <td><a href="{{ .end.RelPermalink }}">{{ .end.Date.Format "Jan 2, 2006" }}</a></td>
      <td>{{ .length }}</td>
      <td>{{ .note | default ""}}</td>
    </tr>
  {{ end }}
</table>

<h2>â›“ Top Streaks, Consec Days Played and Won</h2>

{{ $streaks := partial "streak-days-played-won.html" $wordles }}

<table>
  <tr>
    <th>Start</th>
    <th>End</th>
    <th>Length</th>
    <th></th>
  </tr>

  {{ range first 5 (sort $streaks "length" "desc") }}
    <tr>
      <td><a href="{{ .start.RelPermalink }}">{{ .start.Date.Format "Jan 2, 2006" }}</a></td>
      <td><a href="{{ .end.RelPermalink }}">{{ .end.Date.Format "Jan 2, 2006" }}</a></td>
      <td>{{ .length }}</td>
      <td>{{ .note | default ""}}</td>
    </tr>
  {{ end }}
</table>
<!-- end of streaks -->

<h2>â›³ï¸ Opener Usage</h2>
<table>
  <tr>
    <th>Word</th>
    <th>Count</th>
  </tr>

  {{ $wordCounts := partial "openers.html" $wordles }}

  {{ $minToPrint := 5 }}
  {{ range sort $wordCounts "count" "desc" }}
    {{ if gt .count $minToPrint }}
    <tr>
      <td>{{ .word }}</td>
      <td>{{ .count }}</td>
    </tr>
    {{ end }}
  {{ end }}
  {{ with .Site.GetPage "openers.md" }}
    <tr><td colspan="2"><a href="{{ .RelPermalink }}">ğŸšª See All Openers</a></td></tr>
  {{ end }}
</table>

<h2>ğŸ—“ Monthly Trends</h2>
<table>
  <tr>
    <th>Month</th>
    <th>Puzzles Played</th>
    <th>Avg # Guesses</th>
    <th>Avg Score</th>
  </tr>
  {{ range $wordles.GroupByDate "2006 January" }}
    {{ $guessSum := 0 }}
    {{ $scoreSum := 0 }}

    {{ range .Pages }}
      {{ $guesses := partial "guess-count" . }}
      {{ $guesses = cond (eq $guesses "X") 6 $guesses }}
      {{ $guessSum = add $guessSum $guesses }}

      {{ $score := partial "puzzle-score" . }}
      {{ $scoreSum = add $scoreSum $score }}
    {{ end }}

    <tr>
      <td>{{ .Key }}</td>
      <td>{{ len .Pages }}</td>
      <td>{{ lang.NumFmt 2 (div (float $guessSum) (len .Pages)) }} ({{ $guessSum }})</td>
      <td>{{ lang.NumFmt 1 (div (float $scoreSum) (len .Pages)) }} ({{ $scoreSum }})</td>

    </tr>
  {{ end }}
</table>

<h2>ğŸ§° Tools</h2>
<ul>
  <li><a href="/tools/">Bookmarklets</a></li>
</ul>

<h2>ğŸ“’ Articles</h2>
<ul>
  <li>
  {{ with .Site.GetPage "a/savor.md" }}
    <a href="{{ .RelPermalink }}">{{ .Title }}</a> on {{ .Date.Format "Jan 2, 2006" }}
  {{ end }}
  </li>
</ul>

<h2>ğŸ· Tags</h2>
<ul>
{{range $name, $taxonomy := .Site.Taxonomies.tags}} {{ $cnt := .Count }}
  {{ with $.Site.GetPage (printf "/tags/%s" $name) }}
  <li>
    <a href={{ .RelPermalink }} title="All pages with tag {{$name}}">{{ $name }}</a>
    <sup>{{ $cnt }}</sup>
  </li>
  {{end}}
{{end}}
</ul>

<h2>âœ… Rules / Data Tests</h2>
<ul>
{{ range (where .Site.RegularPages "Section" "r") }}
  <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
{{ end }}
</ul>


<a href="index.xml">RSS</a> | <a href="https://github.com/tphummel/wordle">GitHub</a>
{{ end }}
