{{ define "head" }}
  <meta property="og:url" content=""/>
  <meta property="og:title" content="{{ $.Site.Title }}" />
  <meta property="og:description" content="Wordle puzzle #{{ .Params.puzzle }} completed on {{ .Date.Format "January 2, 2006" }}" />

  <meta property="og:image" content="./puzzle.svg" />
  <meta property="twitter:card" content="image alt text" />

  <meta property="twitter:label1" value="Guesses" />
  <meta property="twitter:data1" value="{{ partial "guess-count" . }}" />
  <meta property="twitter:label2" value="Score" />
  <meta property="twitter:data2" value="{{ partial "puzzle-score.html" . }}" />
  <meta property="twitter:label3" value="Outcome" />
  <meta property="twitter:data3" value="{{ lower .Params.state.gameStatus }}" />
  <meta property="twitter:label4" value="Hard Mode" />
  <meta property="twitter:data4" value="{{ .Params.state.hardMode}}" />

{{ end }}

{{ define "main" }}

<h1>{{.Title}}</h1>

<p>
  {{ partial "breadcrumb.html" . }}
  {{ partial "tag-list.html" . }}
</p>

<p>Date: <strong>{{ .Date.Format "January 2, 2006" }}</strong></p>
<p>Puzzle: <strong>{{ .Params.puzzle | default "--" }}</strong></p>
<p>Outcome: <strong>{{ lower .Params.state.gameStatus}}</strong></p>
<p>Hard Mode: <strong>{{ .Params.state.hardMode}}</strong></p>
<p>
{{ range $g, $guess := .Params.state.boardState }}
  {{ range $c, $char := split $guess "" -}}
    {{ $eval := index $.Params.state.evaluations $g $c }}
    {{- if eq $eval "correct" -}}
      üü©
    {{- else if eq $eval "present" -}}
      üü®
    {{- else -}}
      ‚¨õÔ∏è
    {{- end -}}
  {{ end }}
  {{ if not (eq $guess "") }}<br />{{ end }}
{{ end }}
</p>
<p>
  <details>
    <summary>
      Guesses: <strong>{{ partial "guess-count" . }}</strong> (‚õîÔ∏è Spoilers‚ùóÔ∏è)
    </summary>
    <table>
      <tr>
        <th>#</th>
        <th>Word</th>
        <th>Usage</th>
      </tr>
    {{ $title := .Title }}
    {{ range $g, $guess := .Params.state.boardState }}
      {{ if not (eq $guess "") }}
        {{ with $.Site.GetPage (printf "/words/%s" $guess) }}
          <tr>
            <td>{{ add $g 1 }}</td>
            <td>
              <a href="{{ .RelPermalink }}">{{ $guess }} {{ cond (eq $guess $.Params.state.solution) "‚ú®" ""}}</a>
            </td>
            {{ $guessHistory := index $.Site.Taxonomies.words $guess }}
            {{ $guessSeq := -1 }}
            {{ range $i, $pastGuess := $guessHistory.Pages.ByDate }}
              {{ if eq $pastGuess.Title $title }}
                {{ $guessSeq = $i }}
              {{ end }}
            {{ end }}
            {{ $displayUsage := add $guessSeq 1 }}
            <td>{{ $displayUsage }} / {{ len $guessHistory }} {{ cond (eq $displayUsage 1) "‚úÖ" ""}}</td>
          </tr>
        {{ end }}
      {{ end }}
    {{ end }}
    </table>
  </details>
</p>
<p>
  <details>
    <summary>
      Puzzle Score: <strong>{{ partial "puzzle-score.html" . }}</strong>
    </summary>
    {{ partial "puzzle-score-detail.html" .}}
  </details>
</p>

{{ .Content }}

{{ $wordles := (where .Site.RegularPages "Section" "w")}}
{{ with $wordles.Prev . }}
<div>
  Prev Puzzle: <strong><a href="{{ .RelPermalink }}">{{ .Title }}</a></strong>
</div>
{{ end }}
{{ with $wordles.Next . }}
<div>
  Next Puzzle: <strong><a href="{{ .RelPermalink }}">{{ .Title }}</a></strong>
</div>
{{ end }}
<div style="opacity:0.3">
  <div>Published: {{ dateFormat "2006-01-02 15:04 -0700" .Date }}</div>
  {{ with .GitInfo }}
  <div>Committed: {{ dateFormat "2006-01-02 15:04 -0700" .AuthorDate.Local }}</div>
  {{ end }}
</div>

{{ end }}
